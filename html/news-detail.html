<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
	<title>新闻详情页</title>
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
	<link href="../css/common.css" type="text/css" rel="stylesheet"/>
	<link href="../css/newslist.css" type="text/css" rel="stylesheet"/>
	<style type="text/css"></style>
	<script type="text/javascript" src="../js/libs/zepto.js"></script>
	<script type="text/javascript" src="../js/libs/fastclick.js"></script>
	<script type="text/javascript" src="../js/libs/fx.js"></script>
	<script type="text/javascript" src="../js/libs/slidefx.js"></script>
	<script type="text/javascript" src="../js/libs/touch.js"></script>
	<script type="text/javascript" src="../js/libs/selector.js"></script>
	<script type="text/javascript" src="../js/utils.js"></script>
	<script type="text/javascript" src="../js/libs/ejs.js"></script>
	<script type="text/javascript" src="../js/libs/rng.js"></script>
	<script type="text/javascript" src="../js/libs/md5.js"></script>

	<script id="grayBar-tmpl" type="text/html">
		<div class="grayBar">
			{%tagData.forEach(function(item){%}
				<span class="grayBar-tag">{%=item.name%}</span>
			{%})%}

			{%if(transmit_num){%}
			<a class="grayBar-rt native-call" data-native="news.recommend" href="javascript:;"><span>已被{%=transmit_num%}个自频道转推</span><span class="banner-arr-rt"></span></a>
			{%}%}
		</div>
	</script>
	
	<script id="article-tmpl" type="text/html">
		<section class="article part" data-name="正文">
			{% if(typeof title != 'undefined'){ %}
				<h1>{%=title%}</h1>
			{% } %}

			{% if(typeof editor_name != 'undefined') { %}
				{% // 有小编信息 %}
				<div class="editor-info">
					{% if(time) { %}<time>{%=time%}</time> {%}%}
					<img class="editor-avatar" src="{%=editor_pic%}" width="42" height="42" />
					<div class="editor-name">{%=editor_name%}</div>
					{% if(locals.editor_desc) { %}
						<div class="editor-desc">{%=editor_desc%}</div>
					{% } %}
				</div>
			{% } else { %}
				{% if(typeof source != 'undefined'){ %}
					<div class="article-info">
						{% if(source) { %}<cite class="source">{%=source%}</cite>{% } %}
						{% if(time) { %}<time>{%=time%}</time> {%}%}
						<span class="readCount" data-fmt="{0} 阅读" style="display:none;"></span>
					</div>
				{% } %}
			{% } %}

			{% //正文内容 %}
			{% var contentLen = content.length, openTag = false; %}
			{% content.forEach(function(d, i){ %}

				{% /* 2014-12-04 看点2.0.1，对于文本和图片实现自动分块处理 */ %}
				{% if (openTag && d.type != 'txt' && d.type != 'img') { %}
					{% openTag = false; %}
					</div>
				{% } else if (!openTag && (d.type == 'txt' || d.type == 'img')) { %}
					{% openTag = true; %}
					<div class="block mod">
				{% } %}
				
				{%  if(d.type == 'txt' && d.value){  -%}
					{% if(d.noPTag){ %}
						{%-d.value%}
					{% }else{ %}
						<p class="{%=d.cssClass%}">{%-d.value%}</p>
					{% } %}
				{%  } else if(d.type == 'img'){  -%}
					<div class="photo-mod">
						<div class="photo-wrap">
							<img class="photo lazy native-call" data-native="news.showFullImage" 
							data-param1="{%=d.originalValue%}" 
							data-src="{%=d.value%}" 
							width="{%=d.width%}" 
							height="{%=d.height%}"/>
						</div>
						{% if(d.title) { %}
						<div class="photo-desc {% if(d.descAlignCenter) { %}center{% } %}">{%= d.title %}</div>
						{% } %}
					</div>
				{%  } else if(d.type == 'html'){  -%}
					{%-d.value%}
				{%  } -%}
				
				{% if (i === contentLen - 1 && openTag && (d.type == 'txt' || d.type == 'img')) { %}
					{% openTag = false; %}
					</div>
				{% } %}
			{% }); -%}

		</section>
	</script>

	<!-- 图集 -->
	<script id="mod-gallery-tmpl" type="text/html">
		<div class="gallery mod">
			{% items.forEach(function(item){ %}
			<div class="gallery-wrap">
				<div class="cont gallery relative" data-itemperpage="{%=item.itemPerPage%}" data-trans-url="{%=item.transUrl%}" data-allqimg="{%=item.allqimg%}">
						{% item.items.forEach(function(url, i){ %}
							
								<a href="javascript:;" 
								{% if(!window.$wap){ %}
									class="native-call relative block" 
									data-param1="{%=item.originalPhotos[i]%}"
									data-param2="{%=item.data%}"
									data-native="photo.showFullImage"
								{% } else { %}
									class="relative block" 
								{% } %}
								{%if (i!=0) { %}style="display:none"{% } %}

								data-mfp-src="{%=item.originalPhotos[i]%}">
									<img class="lazy" data-src="{%=url%}" width="100%" height=""/>
									<span class="pages">{%=item.allqimg%}P</span>
									<span class="galleryflag"><span>
								</a>
							
						{% }); %}
				</div>
				{% if(item.title) { %}
					<h3>图片：{%=item.title%}</h3>
				{% } %}
			</div>
			{% }); %}
		</div>
	</script>

	<!-- 视频 -->
	<script id="mod-video-tmpl" type="text/html">
		<div class="video mod">
			{% items.forEach(function(item){ %}
				<div class="photo" width="100%">
					<a href="javascript:;"
						class="native-call"
						style="position:relative;display:block;" 
						data-native="video.play" 
						data-param1="{%=item.url%}">
						<img class="snapshot lazy" data-src="{%=item.imgurl%}" width="100%" height=""/>
						<img class="play" src="../images/icon-video-play.png" />
					</a>
				</div>

				{% if(item.title) { %}
					<h4>视频：{%=item.title%}</h4>
				{% } %}

			{% }); %}
		</div>
	</script>

	<!-- 相关阅读 -->
	<script id="recommend-articles-tmpl" type="text/html">
		<section class="recommend-articles part" data-name="推荐" >

			<h2 class="title">相关阅读</h2>
			<ul class="articles-list">
				{% related.forEach(function(item,i){ %}
				{% if(i % 2 == 0 && i != 0){%}
					</ul>
					<ul class="articles-list">
				{% } %}
				<li class="native-call" data-native="related.viewRelatedArticel" data-param1="{%=item.url%}">
					
					{% if(item.img){ %}
					<img class="photo lazy" data-src="{%=item.img%}" width="{%=item.width%}" height="{%=item.height%}" />
					{% } else if(item.summary){ %}
					<p>{%=item.summary%}</p>
					{% } %}
					
					<a class="title-link" href="javascript:;" data-href="{%=item.url%}">
						<div class="row3">{%=item.title%}</div>
					</a>
					<div class="time-tips">
						{% if (typeof item.elapse == 'string') { %}
							 <i>{%=item.elapse%}</i>
						{% } %}
					</div>
				</li>
				
				{% }); %}
			</ul>
		</section>
	</script>

	<script id="hot-articles-tmpl" type="text/html">
		<section class="hot-articles part" data-name="热门推荐"%}>
			<h2 class="title">热门推荐</h2>
			<ul class="articles-list">
				{% hotNewsList.forEach(function(item,i){ %}
					<li class="native-call flex" data-native="related.viewHotArticel" data-param1="{%=item.url%}">
						<a class="flex-item txts" href="javascript:;" data-href="{%=item.url%}">
							<div class="title-link row2" >{%=item.title%}</div>
							<p>
								{% if (typeof item.elapse == 'string') { %}
									 <i>{%=item.elapse%}</i>
								{% } %}
							</p>
						</a>
						<div class="hot-img">
						{% if(item.img){ %}
							<img class="photo lazy" data-src="{%=item.img%}" width="{%=item.width%}" height="{%=item.height%}" />
						{% } else if(item.summary){ %}
							<p>{%=item.summary%}</p>
						{% } %}
						</div>
					</li>
				{% }); %}
			</ul>
		</section>
	</script>
	<script id="share-buttons-tmpl" type="text/html" >
		<section class="share-buttons-wrap part" data-name="分享模块">
			<div class="share-buttons">
				<h2 class="title">分享</h2>
				<ul>
					<li class="button circle">
						<a class="native-call" href="javascript:;" data-native="news.share" data-param1="circle"><img src="../images/share-circle.png" /></a>
						<span>朋友圈</span>
					</li>
					<li class="button weixin">
						<a class="native-call" href="javascript:;" data-native="news.share" data-param1="weixin"><img src="../images/share-weixin.png"/></a>
						<span>微信</span>
					</li>
					
					<li class="button weibo">
						<a class="native-call" href="javascript:;" data-native="news.share" data-param1="weibo"><img src="../images/share-weibo.png" /></a>
						<span>微博</span>
					</li>

					<li class="button copy">
						<a class="native-call" href="javascript:;" data-native="news.share" data-param1="copy"><img src="../images/share-copy.png" /></a>
						<span>复制链接</span>
					</li>
					
				</ul>
			</div>

	</script>

	<script id="comments-tmpl" type="text/html" >
		<section class="comments part {% if(typeof more != 'undefined' && !window.$wap) { %} has-more {% } %}" data-name="评论">
			{% if(typeof title != 'undefined'){ %}
			<h2 class="title">{%=title%}</h2>
			{% } else { %}
			<h2 class="title">热门评论</h2>
			{% } %}

			{% if(_comments.length > 0){ //有评论%}
				<!-- comment-items-begin -->
				<ul class="comment-list">
					{% _comments.forEach(function(item){ %}
						{% if(!item.text || item.text.length == 0) return; %}
					<li>
						<a class="native-call" href="javascript:;" data-native="news.commUser" data-param1="{%=item.cid%}">
							{% if(item.avatarUrl) {%}
							<img class="avatar" src="{%=item.avatarUrl%}" />
							{% } else { %}
							<img class="avatar" src="../images/icon-default-avatar.png" />
							{% } %}
						</a>
						<div class="info-text">
							<div class="info">
								<a class="thumbup native-call" href="javascript:;" data-native="news.likeThisComment" data-param1="{%=item.cid%}">
									<img src="../images/icon-thumbup.png" />
								</a>
								<a class="thumbup-active" style="display:none;" href="javascript:;">
									<img src="../images/icon-thumbup-active.png" />
								</a>
								<span class="liked">{%=item.liked%}</span>
								<span class="username">{%=item.username%}</span>
							</div>
							<div class="text">
								{%=item.text%}
							</div>
							<div class="time">
								{%=item.time%}
							</div>
						</div>
					</li>
					{% }); %}
				</ul>
				<!-- comment-items-end -->
			{% } else { //没有评论%}
				<ul class="comment-list" style="display:none;"></ul>
				<div class="no-comments native-call" data-native="news.comment">
					{% if(window.$wap) { %}
						还没评论呢...
					{% } else { %}
						还没评论呢，你来吧
					{% } %}
				</div>
			{% } %}

			{% if(typeof more != 'undefined' && !window.$wap){ %}
				<a class="more-comments native-call" 
				data-native="news.showComments"
				href="javascript:;">{%=more%}</a>
			{% } %}
		</section>
	</script>
</head>
<body>

	<div class="wrapper"></div>
	<div class="pop"></div>
	<style type="text/css">
		.pop-fixed{
			position: fixed;
			width: 100%;
			height: 100%;
			z-index: 1200;
			background: rgba(0,0,0,.8);
			top: 0;
			left: 0;
		}

		/* download bar in wap */
		.sx-download-bar{
			height: 40px;
			border-top: 1px solid #e5e5e5;
			background: #fff url(http://p7.qhimg.com/d/inn/032c38a5/download-bar-h5.png) no-repeat 15px 50%;
			background-size: 115px auto;
			position: fixed;
			bottom: 0;
			width: 100%;
			z-index: 1999;
		}
		.sx-btn-download{
			display: block;
			color: #fff;
			font-size: 16px;
			background-color: #ec4346;
			line-height: 30px;
			height: 30px;
			padding:0 15px;
			border-radius: 3px;
			position: absolute;
			right: 15px;
			top: 5px

		}
	</style>
	<div class="sx-download-bar">
    	<a href="#" class="sx-btn-download">下载</a>
    </div>
	<script type="text/javascript" src="../js/nativeApi.js"></script>
	<script type="text/javascript" src="../js/contentRender.js"></script>
	<script type="text/javascript" src="../js/waponly.js"></script>
	<script deletecur type="text/javascript" src="../js/data/detail-n.js"></script>
	<script deletecur>
		$(function(){
			window.$wap = true;
			var cont = dataDetailNews.data;
			var comm = commData.data;
			var related = relatedNews.data;


			var hotNewsData = hotNews.data;
			$ContentRender.renderGrayBar(cont);
			$ContentRender.renderArticle(cont);
			/*相关阅读*/
			$ContentRender.renderRecommendArtices(related);
			/*热门推荐*/
			$ContentRender.renderhotArtices(hotNewsData);
			$ContentRender.renderShareButtons({});
			
			$ContentRender.renderComments(comm);
			$ContentRender.lazyLoadImage();
			$ContentRender.done();
			/*$.ajax({
				url:"http://zm.kandian.360.cn/index.php?c=index&a=trans&from=h5&m=3fe50e8cb21355700f042010505ea2985d532773&id=1665613463555970&fmt=json&url=http://news.sohu.com/20151124/n427839277.shtml",
				data:'',
				type:"get",
				dataType: "jsonp",
				success:function(data){
					console.log("ajax")
					console.log(data);
				}
			})*/
		});
	</script>


</body>
</html>