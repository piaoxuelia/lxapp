/*! lxapp 2015-12-30 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=function(){var a=function(a){var b=arguments[0];if("undefined"==typeof b||null===b)return{};if("object"!=typeof b)return b;var c=arguments[1],d=!0;c instanceof Array||(c=b,d=!1);var e,f={};for(e in c)attr=d?c[e]:e,b.hasOwnProperty(attr)&&(b[attr]instanceof Array?f[attr]=cloneArray(b[attr]):"object"==typeof b[attr]?f[attr]=cloneOwn(b[attr]):f[attr]=b[attr]);return f};return{clone_obj:a}}()},{}],2:[function(a,b,c){b.exports=function(){var b=a("./ajaxTools"),c="http://g.live.360.cn/liveplay",d="http://gtest.live.360.cn/liveplay",e="http://g.live.360.cn/replay",f="http://gtest.live.360.cn/replay",g=0,h=function(a,i,j){var k="";k="liveplay"==i.vtype?i.debug?d:c:i.debug?f:e;var l={channel:i.channel,sn:i.sn,_rate:i._rate,stype:i.stype,sid:i.sid,ts:i.ts,_jsonp:i._jsonp};b.ajaxJsonp(k,l,function(b){if(b)j(b),a.trigger("connectSuccess");else if(a.trigger("reconnect"),3>g){g++;var c=Math.floor(0+2*Math.random());switch(c){case 0:setTimeout(function(){h(l,j)},1e3);break;case 1:setTimeout(function(){h(l,j)},3e3);break;case 2:setTimeout(function(){h(l,j)},5e3)}}else a.trigger("connectError"),j(!1)})};return{init:h}}()},{"./ajaxTools":7}],3:[function(a,b,c){!function(b,c){var d=a("./Connect"),e=a("./Video_event"),f=a("./Video_get_attributes"),g=a("./ajaxTools");clone_data=a("./Clone_obj"),H5_video=function(a,b){this._dom=b,this._user_data=a,this._upload_info_url="http://qos.live.360.cn/vc.gif",this._event,this._online_timer,this._back_url_timer,this._sdkver="1.0.0",this._update_info_base_date,this._is_pause=0,this._skin=a.skin||!1,this.check_video()?this.init():console.log("不支持video标签")},H5_video.prototype.init=function(){var a=this;this._video,this._is_waiting=0,this._waiting_start_time=0,this._waiting_end_time=0,this._waiting_num=0,this._is_seek=0,this._total_waiting_time=0,this._is_first_error=1,this._mark_time=0,this._back_url=[],this._update_info_base_date={cid:this._user_data.channel,uid:this._user_data.uid||"",sdkver:this._sdkver,sid:this._user_data.sid||"",bid:this._user_data.bid||"",pid:this._user_data.pid||"H5",ver:"0.0.1",rid:this._user_data.sn,mid:this._user_data.mid||"",tm:(new Date).getTime(),r:Math.random(),ty:"online"};var c={channel:this._user_data.channel,sdkver:this._sdkver,sn:this._user_data.sn,_rate:this._user_data._rate||"xd",stype:this._user_data.stype||"m3u8",vtype:this._user_data.vtype||"",debug:this._user_data.debug||!1,sid:this._user_data.sid||"",ts:(new Date).getTime(),_jsonp:this._user_data._jsonp||"_jsonp"},e=(new Date).getTime();d.init(b(this),c,function(b){if(b){a._back_url=b.back,a._update_info_base_date.u=encodeURI(b.main);var c=a._user_data.width||"100%",d=a._user_data.height||"100%",f=a._user_data.controls?" controls":"",g=a._user_data.autoplay?" autoplay":"",h=a._user_data.loop?'loop="loop"':"",i=a._user_data.preload?a._user_data.preload:"auto",j=a._user_data.poster||"",k="<video "+f+g+' webkit-playsinline="webkit-playsinline" x-webkit-airplay="allow" width="'+c+'" height="'+d+'" '+h+' preload="'+i+'" poster="'+j+'" src="'+b.main+'" ></video>';a._dom.html(k),a._video=a._dom.find("video")[0],a._video.duration=0,a.add_dispatch_event();var l=(new Date).getTime(),m=l-e;a.upload_info_action(0,m),a.upload_info_init(),a._online_timer=setInterval(function(){a.upload_info_online(a._upload_info_url,a._update_info_base_date)},6e4)}else{alert("cdn 返回链接失败");var l=(new Date).getTime(),m=l-e;a.upload_info_action(a.dom.error.code,m)}a._is_first_error=0})},H5_video.prototype.use_back_url=function(){var a=this;clearInterval(a._online_timer),a._back_url.length?(" "!=b.trim(a._back_url[0])&&""!=b.trim(a._back_url[0])?(a._video.src=a._back_url[0],a._update_info_base_date.u=encodeURI(a._back_url[0]),a._back_url.splice(0,1),a._back_url_timer=setInterval(function(){a.upload_info_online(a._upload_info_url,a._update_info_base_date)},6e4)):(a._back_url.splice(0,1),a.use_back_url()),b(this).trigger("backUrlError")):(clearInterval(a._back_url_timer),a._mark_time=0,b(this).trigger("urlError"))},H5_video.prototype.check_video=function(){var a=document.createElement("video");return a.canPlayType?!0:!1},H5_video.prototype.request_full_screen=function(){this._video.requestFullScreen?(this._video.requestFullScreen(),b(this).trigger("requestFullScreen")):this._video.mozRequestFullScreen?(this._video.mozRequestFullScreen(),b(this).trigger("requestFullScreen")):this._video.webkitRequestFullScreen&&(this._video.webkitRequestFullScreen(),b(this).trigger("requestFullScreen"))},H5_video.prototype.cancel_full_screen=function(){this._video.exitFullscreen?(this._video.exitFullscreen(),b(this).trigger("cancelFullScreen")):this._video.mozCancelFullScreen?(this._video.mozCancelFullScreen(),b(this).trigger("cancelFullScreen")):this._video.webkitCancelFullScreen&&(this._video.webkitCancelFullScreen(),b(this).trigger("cancelFullScreen"))},H5_video.prototype.add_dispatch_event=function(){var a=this;a._event=new e.init(a),a._event.add_event()},H5_video.prototype.remove_dispatch_event=function(){var a=this;a._event.remove_event(),a._event=null},H5_video.prototype.canPlayType=function(a){return this._video.canPlayType(a)},H5_video.prototype.pause=function(){this._video.pause()},H5_video.prototype.play=function(){this._video.play()},H5_video.prototype.seek=function(a){this._video.currentTime=a},H5_video.prototype.load=function(){this._video.load()},H5_video.prototype.add_current_time=function(a){this._video.currentTime+=a},H5_video.prototype.reduce_current_time=function(a){this._video.currentTime+=a},H5_video.prototype.add_playback_rate=function(a){this._video.playbackRate+=a},H5_video.prototype.reduce_playback_rate=function(a){this._video.playbackRate-=a},H5_video.prototype.add_volume=function(){this._video.volume+=.1},H5_video.prototype.reduce_volume=function(){this._video.volume-=.1},H5_video.prototype.muted=function(a){this._video.muted=a},H5_video.prototype.change_sn=function(a){this._user_data.sn=a,this.remove_dispatch_event(),clearInterval(this._online_timer),this._is_first_error=1,this.init()},H5_video.prototype.get_attributes=function(){var a=arguments[0],b=arguments[1]||0;switch(a){case"current_time":return f.currentTime(this._video);case"duration":return f.duration(this._video);case"paused":return f.paused(this._video);case"default_playback_rate":return f.defaultPlaybackRate(this._video);case"playback_rate":return f.playbackRate(this._video);case"played_start":return f.played_start(this._video,b);case"played_end":return f.played_end(this._video,b);case"seekable_start":return f.seekable_start(this._video,b);case"seekable_end":return f.seekable_end(this._video,b);case"ended":return f.ended(this._video);case"auto_play":return f.autoPlay(this._video);case"loop":return f.loop(this._video);case"buffered_start":return f.buffered_start(this._video,b);case"buffered_end":return f.buffered_end(this._video,b);case"audioTracks_length":return f.audioTracks_length(this._video);case"audioTracks_get_object_by_id":return f.audioTracks_get_object_by_id(this._video,b);case"audioTracks_get_object_by_index":return f.audioTracks_get_object_by_index(this._video,b);case"controller":return f.controller(this._video);case"current_src":return f.currentSrc(this._video);case"default_muted":return f.defaultMuted(this._video);case"error":return f.error(this._video);case"media_group":return f.mediaGroup(this._video);case"muted":return f.muted(this._video);case"network_state":return f.networkState(this._video);case"ready_state":return f.readyState(this._video);case"volume":return f.volume(this._video);case"textTracks_length":return f.textTracks_length(this._video);case"textTracks_get_object_by_index":return f.textTracks_get_object_by_index(this._video,b);case"textTracks_get_object_by_id":return f.textTracks_get_object_by_id(this._video,b);case"videoTracks_get_object_by_index":return f.videoTracks_get_object_by_index(this._video,b);case"videoTracks_get_object_by_id":return f.videoTracks_get_object_by_id(this._video,b)}},H5_video.prototype.upload_info_init=function(){var a=this;g.ajaxGet(a._upload_info_url,a._update_info_base_date,function(a){a?console.log("调度接口请求成功"):console.log("请求调度接口请求失败")})},H5_video.prototype.upload_info_action=function(a,b){var c=this,d=clone_data.clone_obj(c._update_info_base_date);switch(d.st=2,d.rt=b,d.ty="action",d.er=a,d.tm=(new Date).getTime(),d.r=Math.random(),a){case 0:d.em="调度成功";break;case 1:d.em="用户终止";break;case 2:d.em="网络错误";break;case 3:d.em="解码错误";break;case 4:d.em="URL无效"}g.ajaxGet(c._upload_info_url,d,function(a){a?console.log("调度接口上报成功"):console.log("调度接口上报失败")})},H5_video.prototype.upload_info_online=function(a,b){var c=clone_data.clone_obj(b);c.ty="online",c.tm=(new Date).getTime(),c.r=Math.random(),g.ajaxGet(a,c,function(a){a?console.log("在线接口上报成功"):console.log("在线接口上报失败")})},H5_video.prototype.upload_info_exception=function(a){var b=this,c=clone_data.clone_obj(b._update_info_base_date);switch(c.exception=a,c.st=2,c.ty="action",c.tm=(new Date).getTime(),c.r=Math.random(),c.er=a,a){case 1:c.em="第一次加载时用户终止";break;case 2:c.em="第一次加载时网络错误";break;case 3:c.em="第一次加载时解码错误";break;case 4:c.em="第一次加载时URL无效"}g.ajaxGet(b._upload_info_url,c,function(a){a?console.log("播放过程中的错误接口上报成功"):console.log("播放过程中的错误接口上报失败")})},H5_video.prototype.upload_info_buffer=function(a,b){var c=this,d=clone_data.clone_obj(c._update_info_base_date);switch(d.br=a,d.ty="buffer",d.bc=c._waiting_num,d.po=c._video.currentTime,d.bt=b,d.tm=(new Date).getTime(),d.r=Math.random(),a){case 1:d.em="第一次加载引起的缓冲结束";break;case 2:d.em="因为seek引起得缓冲开始";break;case 4:d.em="因为播放过程中卡引起的缓冲开始"}g.ajaxGet(c._upload_info_url,d,function(a){a?console.log("缓冲原因和时间接口上报成功"):console.log("缓冲原因和时间接口上报失败")})},H5_video.prototype.upload_info_summary=function(a,b){var c=this,d=clone_data.clone_obj(c._update_info_base_date);d.ot=a,d.bc=c._waiting_num,d.pt=b,d.ty="summary",d.tm=(new Date).getTime(),d.r=Math.random(),g.ajaxGet(c._upload_info_url,d,function(a){a?console.log("加上缓冲一共花去的观看影片的时间接口上报成功"):console.log("加上缓冲一共花去的观看影片的时间接口上报失败")})}}(Zepto,window)},{"./Clone_obj":1,"./Connect":2,"./Video_event":4,"./Video_get_attributes":5,"./ajaxTools":7}],4:[function(a,b,c){b.exports=function(){var b=function(b){function c(){$(y._obj).trigger("loadstart"),y._obj._skin&&(x.hide_waiting(y._dom),x.show_play(y._dom)),y._obj._is_waiting=1,y._obj._waiting_start_time=(new Date).getTime()}function d(){$(y._obj).trigger("progress")}function e(){$(y._obj).trigger("suspend")}function f(){$(y._obj).trigger("abort")}function g(a){$(y._obj).trigger("error"),y._obj._is_first_error||y._obj.upload_info_exception(y._dom.error.code),y._obj._mark_time=y._dom.currentTime,y._obj.use_back_url()}function h(){$(y._obj).trigger("stalled"),y._obj._mark_time=y._dom.currentTime}function i(){y._obj._skin&&(x.hide_waiting(y._dom),x.hide_play(y._dom)),$(y._obj).trigger("play")}function j(){y._obj._skin&&(x.show_play(y._dom),x.hide_waiting(y._dom)),y._obj._is_pause=1,$(y._obj).trigger("pause")}function k(){$(y._obj).trigger("loadedmetadata")}function l(){$(y._obj).trigger("loadeddata")}function m(){$(y._obj).trigger("waiting"),y._obj._waiting_num&&y._obj._skin&&(x.show_waiting(y._dom),x.hide_play(y._dom)),y._obj._waiting_num++,y._obj._waiting_start_time=(new Date).getTime()}function n(){y._obj._skin&&(x.hide_waiting(y._dom),x.hide_play(y._dom)),$(y._obj).trigger("playing"),y._obj._waiting_end_time=(new Date).getTime();var a=y._obj._waiting_end_time-y._obj._waiting_start_time;y._obj._total_waiting_time=y._obj._total_waiting_time+a,y._obj._is_pause?y._obj._is_pause=0:y._obj._is_seek?0!=y._obj._waiting_start_time&&y._obj.upload_info_buffer(2,a):0==y._obj._waiting_num?(y._obj.upload_info_buffer(1,a),y._obj._waiting_num++):0!=y._obj._waiting_start_time&&y._obj.upload_info_buffer(4,a),y._obj._waiting_start_time=0,y._obj._waiting_end_time=0,y._obj._is_seek=0}function o(){$(y._obj).trigger("canplay"),y._obj._mark_time&&(y._dom.currentTime=y._obj._mark_time,y._obj._mark_time=0)}function p(){$(y._obj).trigger("canplaythrough")}function q(){y._obj._is_seek=1,$(y._obj).trigger("seeking")}function r(){$(y._obj).trigger("seeked")}function s(){$(y._obj).trigger("timeupdate")}function t(){y._obj.upload_info_summary(y._obj._total_waiting_time+y._obj._video.currentTime,y._obj._video.currentTime),y._obj._total_waiting_time=0,y._obj._waiting_num=0,clearInterval(y._obj._online_timer),y._obj._is_first_error=1,y._obj._mark_time=0,$(y._obj).trigger("ended")}function u(){$(y._obj).trigger("ratechange")}function v(){$(y._obj).trigger("durationchange")}function w(){$(y._obj).trigger("volumechange")}var x=a("./Video_skin"),y=this;y._obj=b,y._dom=b._video,y.add_event=function(){y._dom.addEventListener("loadstart",c,!1),y._dom.addEventListener("progress",d,!1),y._dom.addEventListener("suspend",e,!1),y._dom.addEventListener("abort",f,!1),y._dom.addEventListener("error",g,!1),y._dom.addEventListener("stalled",h,!1),y._dom.addEventListener("play",i,!1),y._dom.addEventListener("pause",j,!1),y._dom.addEventListener("loadedmetadata",k,!1),y._dom.addEventListener("loadeddata",l,!1),y._dom.addEventListener("waiting",m,!1),y._dom.addEventListener("playing",n,!1),y._dom.addEventListener("canplay",o,!1),y._dom.addEventListener("canplaythrough",p,!1),y._dom.addEventListener("seeking",q,!1),y._dom.addEventListener("seeked",r,!1),y._dom.addEventListener("timeupdate",s,!1),y._dom.addEventListener("ended",t,!1),y._dom.addEventListener("ratechange",u,!1),y._dom.addEventListener("durationchange",v,!1),y._dom.addEventListener("volumechange",w,!1),$("body").delegate(".js_h5_sdk_play_dom","touchend",function(){y._dom.play()})},y.remove_event=function(){y._dom.removeEventListener("loadstart",c,!1),y._dom.removeEventListener("progress",d,!1),y._dom.removeEventListener("suspend",e,!1),y._dom.removeEventListener("abort",f,!1),y._dom.removeEventListener("error",g,!1),y._dom.removeEventListener("stalled",h,!1),y._dom.removeEventListener("play",i,!1),y._dom.removeEventListener("pause",j,!1),y._dom.removeEventListener("loadedmetadata",k,!1),y._dom.removeEventListener("loadeddata",l,!1),y._dom.removeEventListener("waiting",m,!1),y._dom.removeEventListener("playing",n,!1),y._dom.removeEventListener("canplay",o,!1),y._dom.removeEventListener("canplaythrough",p,!1),y._dom.removeEventListener("seeking",q,!1),y._dom.removeEventListener("seeked",r,!1),y._dom.removeEventListener("timeupdate",s,!1),y._dom.removeEventListener("ended",t,!1),y._dom.removeEventListener("ratechange",u,!1),y._dom.removeEventListener("durationchange",v,!1),y._dom.removeEventListener("volumechange",w,!1),$(".js_h5_sdk_play_dom").unbind()}};return{init:b}}()},{"./Video_skin":6}],5:[function(a,b,c){b.exports=function(){var a=0,b=0,c=function(c){return 2>a?a++:2==a&&(a++,c.currentTime>1e3&&(b=c.currentTime)),b?_currentTime=c.currentTime-b:_currentTime=c.currentTime,_currentTime},d=function(a){return a.duration},e=function(a){return a.paused},f=function(a){return a.defaultPlaybackRate},g=function(a){return a.playbackRate},h=function(a,b){return a.played.start(b)},i=function(a,b){return a.played.end(b)},j=function(a,b){return a.seekable.start(b)},k=function(a,b){return a.seekable.end(b)},l=function(a){return a.ended},m=function(a){return a.autoplay},n=function(a){return a.loop},o=function(a,b){return a.buffered.start(b)},p=function(a,b){return a.buffered.end(b)},q=function(a){return a.audioTracks.length},r=function(a,b){return a.audioTracks.getTrackById(b)},s=function(a,b){return a.audioTracks[b]},t=function(a){return a.controller},u=function(a){return a.currentSrc},v=function(a){return a.defaultMuted},w=function(a){return a.error},x=function(a){return a.mediaGroup},y=function(a){return a.muted},z=function(a){return a.volume},A=function(a){return a.networkState},B=function(a){return a.readyState},C=function(a){return a.textTracks.length},D=function(a,b){return a.textTracks[b]},E=function(a,b){return a.textTracks.getTrackById(b)},F=function(a,b){return a.videoTracks[b]},G=function(a,b){return a.videoTracks.getTrackById(b)};return{currentTime:function(a){return c(a)},duration:function(a){return d(a)},paused:function(a){return e(a)},defaultPlaybackRate:function(a){return f(a)},playbackRate:function(a){return g(a)},played_start:function(a,b){return h(a,b)},played_end:function(a,b){return i(a,b)},seekable_start:function(a,b){return j(a,b)},seekable_end:function(a,b){return k(a,b)},ended:function(a){return l(a)},autoPlay:function(a){return m(a)},loop:function(a){return n(a)},buffered_start:function(a,b){return o(a,b)},buffered_end:function(a,b){return p(a,b)},audioTracks_length:function(a){return q(a)},audioTracks_get_object_by_id:function(a,b){return r(a,b)},audioTracks_get_object_by_index:function(a,b){return s(a,b)},controller:function(a){return t(a)},currentSrc:function(a){return u(a)},defaultMuted:function(a){return v(a)},error:function(a){return w(a)},mediaGroup:function(a){return x(a)},muted:function(a){return y(a)},networkState:function(a){return A(a)},readyState:function(a){return B(a)},volume:function(a){return z(a)},textTracks_length:function(a){return C(a)},textTracks_get_object_by_index:function(a,b){return D(a,b)},textTracks_get_object_by_id:function(a,b){return E(a,b)},videoTracks_get_object_by_id:function(a,b){return G(a,b)},videoTracks_get_object_by_index:function(a,b){return F(a,b)}}}()},{}],6:[function(a,b,c){b.exports=function(){var a=function(a){if($(".js_h5_sdk_waiting_dom").length)$(".js_h5_sdk_play_dom").hide(),$(".js_h5_sdk_waiting_dom").show();else{var b='<a type="button" class="js_h5_sdk_waiting_dom"></a>';$(a).after(b)}},b=function(a){$(a).next(".js_h5_sdk_waiting_dom").hide()},c=function(a){if($(".js_h5_sdk_play_dom").length)$(".js_h5_sdk_waiting_dom").hide(),$(".js_h5_sdk_play_dom").show();else{var b='<a type="button" style="4px solid green" class="js_h5_sdk_play_dom"></a>';$(a).after(b)}},d=function(a){$(a).next(".js_h5_sdk_play_dom").hide()};return{show_waiting:a,hide_waiting:b,show_play:c,hide_play:d}}()},{}],7:[function(a,b,c){b.exports=function(){var a=function(a,b,c){$.ajax({type:"POST",url:a,cache:!1,data:b,xhrFields:{withCredentials:!0},success:function(a){c(a)},error:function(){c(!1)}})},b=function(a,b,c){$.ajax({type:"GET",url:a,cache:!1,data:b,xhrFields:{withCredentials:!0},success:function(a){c(a)},error:function(){c(!1)}})},c=function(a,b,c){$.ajax({type:"GET",dataType:"jsonp",jsonp:"callbackfn",jsonpCallback:b._jsonp,url:a,cache:!1,data:b,xhrFields:{withCredentials:!0},success:function(a){c(a)},error:function(){c(!1)}})};return{ajaxPost:a,ajaxGet:b,ajaxJsonp:c}}()},{}]},{},[3]);